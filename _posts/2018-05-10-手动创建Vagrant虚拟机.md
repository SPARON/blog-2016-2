---
layout: post
title: 手动创建Vagrant虚拟机
date: 2018-05-10
categories: [环境配置]
description: 网络下载不太靠谱，官方镜像网站下载速度太慢，可以尝试手动自己创建。简单几步即可创建，需要注意的是权限和virtulbox addition的安装，否则会出错哦！
keywords: vagrant
---

# 操作步骤
1. VirtualBox安装虚拟机
2. 配置用户名（建议用户名、密码都用：vagrant）
3. 配置用户免密执行sudo权限命令
4. 安装VBoxGuestAditions.iso
5. 如果用户名、密码为vagrant可添加ssh key到用户目录（~/.ssh/authorized_keys）
6. vagrant package --base <VB虚拟机名称> --output <输出box名称>
7. vagrant box add <输出box名称> --name <vagrant管理名称>
8. vagrant init <vagrant管理名称>
9. vagrant up
10. vagrant ssh

# 安装过程中遇到的问题

## SSH用户名密码未配置

由于虚拟机内未配置ssh key，导致vagrant启动虚拟机后无法连接。

![](/resources/2018-05-10-手动创建Vagrant虚拟机/1-ssh用户名密码未配置_1.PNG)

**解决方案：**

1. 在vagrantfile中添加ssh用户名、密码配置
2. 将ssh key文件添加到用户目录的`.ssh`目录下



## 用户sudo权限未免密

![](/resources/2018-05-10-手动创建Vagrant虚拟机/2-用户sudo权限未免密_1.PNG)
![](/resources/2018-05-10-手动创建Vagrant虚拟机/2-用户sudo权限未免密_2.PNG)

**解决方案**

1. `vi /etc/sudoers`添加`NOPASSWD:`



## virtualbox additions未安装

![](/resources/2018-05-10-手动创建Vagrant虚拟机/3-virtualbox additions未安装_1.PNG)

## 成功启动
![](/resources/2018-05-10-手动创建Vagrant虚拟机/4-成功.PNG)



# 参考资料

1. https://blog.csdn.net/hel12he/article/details/51089774